# swiss-cheese
ðŸ§€ðŸ§€ A demo repository of simple OWASP Top 10 type of vulnerabities in Python. Like swiss-cheese, this code is full of holes ðŸ§€ðŸ§€

There are plenty of demo web apps with vulnerabities, this is mean to to provide smaller interactive demonstrations so students can problem specific vulnerabities atomically.

![License](https://img.shields.io/github/license/austimkelly/swiss-cheese.svg) 
![GitHub Actions](https://github.com/austimkelly/swiss-cheese/workflows/CodeQL/badge.svg)
![Python 3](https://img.shields.io/badge/python-3-blue.svg)


# Purpose

The code samples here hserve several purposes:

1. For application security and training developers, it's easier to see an exploitable vulnerabity in code that you can actually reproduce. Too many times vulnerabities are too abstract, not reproducible, or reachable thus making alerts largely ignored _en masse_. 
2. Static Applicaiton Security Testing (SAST) - SAST tools are notoriously noisy, don't demonstrate reachabliity, and can't find more complex interactions. SAST tools definitley have their place, but should only be used as a backstop after good desing, threat modeling, and peer code reviews. This repository runs Github Advanced Security CodeQL scanner to see how well they do with finding what should be very simple OWASP Top 10 vulnerabities.
3. AI Assistants, such as Github's CoPilot - Most developers have problably used some kind of LLM (ChatGPT, CoPilot) by this point to generate code. I've also used these examples to have CoPilot do a security analysis of simple programs with simple prompts:
    * What security concers are there in this script?
    * How would you recommend fixing vulnerabity X?
4. Will ChatGPT generate insecure code and testing techinques which is may deem unethical?

# Code Authors

Unless otherwise sited in the code, the scripts herein are generated by ChatGPT and Github Copilot with my own promts and subsequent edits.  There's no way to properly attribute the original source(s) of source code used to train the LLM.

# Installation Guide

Follow these steps to install the necessary dependencies for the project:

1. Clone the repository:

`git clone git@github.com:austimkelly/swiss-cheese.git`

2. Navigate to the project directory:

`cd swiss-cheese`

3. Install the dependencies from the `requirements.txt` file:

`pip3 install -r requirements.txt`

4. Navigate to the directory for the demo you want to run and run the python file there (e.g. `python3 idor.py`):

* [broken-auth](./broken-auth/) - Demonstrates a session management vulnerabity if an attacker get ahold of an authentication session token. See also [OWASP Session Management Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html).
    
    * This source code example also demonstrates sensitive data exposure where passwords are stored in code. See [OWASP Secrets Management Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Secrets_Management_Cheat_Sheet.html).

# Demo Listing & References

* [idor](./idor/) - Demonstrates broken access control for easily guessable IDs and no authentication. See also [OWASP IDOR](https://owasp.org/www-chapter-ghana/assets/slides/IDOR.pdf).
* [sqli](./sqli/) - Dmonstrates standard SQL Injection being able to dump a database from a form field. See also [OWASP SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection).
* [ssrf](./ssrf/) - Demonstrate a server side request forgery tricking the app to making a call to an not allowed 3rd party domain. See also [OWASP Server Side Request Forgery](https://owasp.org/www-community/attacks/Server_Side_Request_Forgery).
* [xss](./xss/) - Demonstrates executing arbitraty javascript inside the applicaiton. See also [OWASP Cross Site Scripting](https://owasp.org/www-community/attacks/xss/)
* [secrets](./secrets/) - An example of leaking a secrets file or environment variable configuration. These should all be caught by [Github Secrets Push Protection](https://docs.github.com/en/enterprise-cloud@latest/code-security/secret-scanning/push-protection-for-repositories-and-organizations).

# References to other Pythoh vulnerable web apps

* [Pygoat](https://github.com/austimkelly/pygoat - This is a fork of an intentionally vulnerable web app built with Django and Python. The fork enables Github Advanced security (GHAS) features: CodeQL, Secrets Scanning & Dependabot.
* [Damn Vulnerable Python Web App](https://github.com/austimkelly/dvpwa) - This is also a fork with GHAS enabled.
